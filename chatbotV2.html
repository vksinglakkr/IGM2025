<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>IGM Mitra – International Gita Mahotsav 2025</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&family=Playfair+Display:wght@700;900&family=Noto+Sans+Devanagari:wght@400;500;600;700&display=swap" rel="stylesheet">
 <style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: radial-gradient(ellipse at top, #1e3a8a, #0f172a);
    font-family: 'Poppins', sans-serif;
    min-height: 100vh;
    position: relative;
    overflow-x: hidden;
  }
  body::before {
    content: '';
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background-image: 
      radial-gradient(circle at 20% 50%, rgba(251, 191, 36, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 80% 80%, rgba(249, 115, 22, 0.1) 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
  }
  .devanagari { font-family: 'Noto Sans Devanagari', sans-serif; }
  .playfair { font-family: 'Playfair Display', serif; }
  .container-main { position: relative; z-index: 1; }
  .glass-card {
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.1) inset;
  }
  .gradient-text {
    background: linear-gradient(135deg, #ff6b35 0%, #f59e0b 50%, #ff6b35 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    background-size: 200% auto;
    animation: shimmer 3s linear infinite;
  }
  .mic-btn {
    transition: all 0.3s;
    -webkit-tap-highlight-color: transparent;
  }
  .mic-btn.recording {
    background: linear-gradient(135deg, #dc2626, #ef4444) !important;
    border-color: #dc2626 !important;
    animation: pulseRec 1.5s ease-in-out infinite;
  }
  @keyframes pulseRec {
    0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }
    50% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
  }
  @keyframes shimmer { to { background-position: 200% center; } }
  .header-glow { position: relative; }
  .header-glow::before {
    content: '';
    position: absolute;
    top: -20px; left: 50%;
    transform: translateX(-50%);
    width: 200px; height: 200px;
    background: radial-gradient(circle, rgba(251, 191, 36, 0.3), transparent 70%);
    filter: blur(40px);
    pointer-events: none;
  }
  .tts-btn {
    padding: 8px 16px;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    border: none;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .tts-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
  .tts-btn.speaking { animation: pulse 1.5s ease-in-out infinite; }
  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.05); }
  }
  .lang-toggle {
    display: inline-flex;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    padding: 4px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  .lang-toggle button {
    padding: 8px 20px;
    border-radius: 10px;
    transition: all 0.3s;
    font-size: 14px;
    font-weight: 600;
    border: none;
    background: transparent;
    color: #64748b;
  }
  .lang-toggle button.active {
    background: linear-gradient(135deg, #1e40af, #3b82f6);
    color: white;
    box-shadow: 0 4px 12px rgba(30, 64, 175, 0.4);
    transform: scale(1.05);
  }
  
/* Radio Button Styles */
.query-type-selector {
  background: linear-gradient(135deg, #fef3c7, #fed7aa);
  border: 3px solid #f59e0b;
  border-radius: 20px;
  padding: 20px 16px;
  margin-bottom: 24px;
  box-shadow: 0 8px 24px rgba(245, 158, 11, 0.3);
}

.radio-option {
  position: relative;
  display: flex;
  align-items: flex-start; /* Changed from center to flex-start */
  padding: 14px 16px;
  background: white;
  border: 3px solid #e5e7eb;
  border-radius: 16px;
  cursor: pointer;
  transition: all 0.3s;
  margin-bottom: 12px;
  min-height: 80px; /* Ensure consistent height */
}

.radio-option:last-child {
  margin-bottom: 0;
}

.radio-option:hover {
  border-color: #f59e0b;
  transform: translateX(4px);
  box-shadow: 0 4px 16px rgba(245, 158, 11, 0.2);
}

.radio-option input[type="radio"] {
  width: 22px;
  height: 22px;
  min-width: 22px; /* Prevent shrinking */
  margin-right: 12px;
  margin-top: 2px; /* Align with first line of text */
  cursor: pointer;
  accent-color: #f59e0b;
  flex-shrink: 0; /* Prevent radio from shrinking */
}

.radio-option.selected {
  border-color: #f59e0b;
  background: linear-gradient(135deg, #fffbeb, #fef3c7);
  box-shadow: 0 6px 20px rgba(245, 158, 11, 0.3);
  transform: scale(1.02);
}

.radio-icon {
  font-size: 28px; /* Slightly smaller for mobile */
  min-width: 36px; /* Fixed width */
  margin-right: 8px;
  flex-shrink: 0; /* Prevent icon from shrinking */
  line-height: 1;
  margin-top: 2px;
}

.radio-label {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-width: 0; /* Allow text to wrap properly */
  gap: 2px;
}

.radio-label-title {
  font-size: 16px; /* Reduced from 18px */
  font-weight: 700;
  color: #1f2937;
  line-height: 1.3;
  word-wrap: break-word;
  overflow-wrap: break-word;
  hyphens: auto; /* Enable hyphenation if needed */
}

.radio-label-desc {
  font-size: 12px; /* Reduced from 13px */
  color: #6b7280;
  line-height: 1.4;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

/* Mobile optimization */
@media (max-width: 640px) {
  .query-type-selector {
    padding: 16px 12px;
  }
  
  .radio-option {
    padding: 12px 12px;
    min-height: 85px;
  }
  
  .radio-option input[type="radio"] {
    width: 20px;
    height: 20px;
    min-width: 20px;
    margin-right: 10px;
  }
  
  .radio-icon {
    font-size: 24px;
    min-width: 32px;
    margin-right: 6px;
  }
  
 .radio-label-title {
  font-size: 16px;
  font-weight: 700;
  color: #1f2937;
  line-height: 1.3;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

  .radio-label-desc {
    font-size: 11px;
    line-height: 1.35;
  }
}

/* Very small screens */
@media (max-width: 360px) {
  .radio-label-title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
}
  
  .radio-icon {
    font-size: 22px;
    min-width: 28px;
  }
  
  .radio-label-title {
    font-size: 14px;
  }
  
  .radio-label-desc {
    font-size: 10.5px;
  }
}  
  /* Progressive Disclosure Animation */
  .slide-fade-enter {
    animation: slideFadeIn 0.5s ease-out;
  }
  @keyframes slideFadeIn {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Custom textarea styling - Placeholder smaller, Typed text larger */
  #userInput::placeholder {
    font-size: 13px;
    color: #b5b5b5;
    font-weight: 400;
    opacity: 0.8;
  }
  #userInput {
    font-size: 17px !important;
    font-weight: 600 !important;
    color: #1f2937 !important;
    line-height: 1.5;
    vertical-align: bottom;
  }
  
  /* Fix textarea width and alignment */
  #userInput {
    width: 100% !important;
    box-sizing: border-box !important;
    display: block;
  }
  
  /* Mobile optimization */
  @media (max-width: 768px) {
    #userInput {
      font-size: 16px !important;
      padding: 12px !important;
      padding-bottom: 48px !important;
      min-height: 100px;
    }
    #userInput::placeholder {
      font-size: 12px;
    }
    .mic-btn {
      bottom: 8px !important;
      right: 8px !important;
    }
  }
  
  .icon { display: inline-block; width: 1em; height: 1em; vertical-align: -0.125em; }
  .btn-primary {
    background: linear-gradient(135deg, #ff6b35, #f59e0b);
    color: white;
    font-weight: 700;
    padding: 18px 32px;
    border-radius: 16px;
    border: none;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 8px 24px rgba(255, 107, 53, 0.4);
    position: relative;
    overflow: hidden;
  }
  .btn-primary::before {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.5s;
  }
  .btn-primary:hover::before { left: 100%; }
  .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 12px 32px rgba(255, 107, 53, 0.5); }
  .event-card {
    border-radius: 20px;
    padding: 20px;
    transition: all 0.3s;
    cursor: pointer;
    position: relative;
    overflow: hidden;
  }
  .event-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 16px 40px rgba(0,0,0,0.2); }
  .quote-section {
    background: linear-gradient(135deg, #eff6ff, #dbeafe);
    border-left: 6px solid #3b82f6;
    border-radius: 24px;
    padding: 32px;
    box-shadow: 0 8px 24px rgba(59, 130, 246, 0.15);
    position: relative;
    overflow: hidden;
  }
  .quote-section::before {
    content: '"';
    position: absolute;
    top: -20px; left: 20px;
    font-size: 120px;
    color: rgba(59, 130, 246, 0.1);
    font-family: Georgia, serif;
  }
  input, textarea, select { transition: all 0.3s; }
  input:focus, textarea:focus, select:focus { transform: translateY(-2px); }
  .modal-enter { animation: modalEnter 0.3s ease-out; }
  @keyframes modalEnter {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
  }
  .floating { animation: floating 3s ease-in-out infinite; }
  @keyframes floating {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
  }
  .om-symbol {
    position: fixed;
    font-size: 150px;
    color: rgba(251, 191, 36, 0.05);
    pointer-events: none;
    z-index: 0;
  }
  .om-top-right { top: 50px; right: 50px; transform: rotate(15deg); }
  .om-bottom-left { bottom: 50px; left: 50px; transform: rotate(-15deg); }
</style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">
  <div class="om-symbol om-top-right devanagari">ॐ</div>
  <div class="om-symbol om-bottom-left devanagari">ॐ</div>

  <div class="container-main w-full max-w-5xl glass-card rounded-3xl shadow-2xl overflow-hidden">
    <div class="relative bg-gradient-to-br from-orange-50 via-amber-50 to-yellow-50 p-2 pb-.001 text-center header-glow">
      <div class="flex justify-end mb-2">
        <div class="lang-toggle">
          <button class="langBtn active" data-lang="Hindi">हिंदी</button>
          <button class="langBtn" data-lang="English">English</button>
        </div>
      </div>
      
      <div class="floating">
        <h1 class="text-5xl md:text-6xl font-black gradient-text mb-2 playfair tracking-tight">IGM Mitra</h1>
      </div>
      <p class="text-sm text-gray-600 font-semibold mb-3 tracking-wide">Gita Wisdom & Mahotsav Guide</p>
      
      <div class="w-full max-w-2xl mx-auto px-4">
        <div class="bg-white rounded-2xl border-3 border-orange-400 py-2 px-4 shadow-xl transform hover:scale-105 transition-all duration-300">
          <h2 class="text-sm sm:text-base md:text-lg font-black text-center bg-gradient-to-r from-orange-600 via-orange-500 to-amber-600 bg-clip-text text-transparent whitespace-nowrap">
            International Gita Mahotsav 2025
          </h2>
        </div>
      </div>
    </div>

    <div class="p-2">
      <!-- Query Type Selection - Always Visible -->
      <div class="query-type-selector">
        <h3 class="text-xl font-bold text-gray-900 mb-4 text-center flex items-center justify-center gap-2">
          <svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
          Area of interest?
        </h3>
        
        <div class="radio-option" onclick="selectQueryType('gita')">
          <input type="radio" name="queryType" id="gitaRadio" value="gita">
          <span class="radio-icon">🕉️</span>
          <label for="gitaRadio" class="radio-label cursor-pointer">
            <span class="radio-label-title">Gita Guidance (गीता मार्गदर्शन)</span>
            <span class="radio-label-desc">Life wisdom, spiritual questions, peace of mind, handling emotions</span>
          </label>
        </div>
        
        <div class="radio-option" onclick="selectQueryType('event')">
          <input type="radio" name="queryType" id="eventRadio" value="event">
          <span class="radio-icon">🎪</span>
          <label for="eventRadio" class="radio-label cursor-pointer">
            <span class="radio-label-title">Festival Information (महोत्सव की जानकारी)</span>
            <span class="radio-label-desc">Events, schedule, facilities, transport, accommodation, tourist places</span>
          </label>
        </div>
      </div>

      <!-- Question Input Section - Hidden Initially -->
      <div id="questionSection" style="display: none;">
        <div class="mb-8 slide-fade-enter">
          <div class="relative">
            <textarea
              id="userInput"
              rows="3"
              class="w-full rounded-2xl border-4 border-orange-400 p-4 pb-12 text-gray-900
                     bg-gradient-to-br from-white to-orange-50 shadow-2xl resize-none
                     focus:border-orange-500 focus:ring-4 focus:ring-orange-200 focus:shadow-2xl
                     transition-all duration-300 leading-relaxed"
              placeholder="Type your question here..."
            ></textarea>
            <button
              id="voiceBtn"
              class="mic-btn absolute bottom-3 right-3 text-orange-500 hover:text-orange-700 transition-all duration-300 hover:scale-110 bg-white rounded-full p-3 shadow-lg border-2 border-orange-300"
              title="Click to speak"
            >
              <svg id="micIcon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
              </svg>
            </button>
          </div>
        </div>

        <div class="mb-8 slide-fade-enter" id="quickQuestionsSection">
          <div class="flex items-center justify-between mb-4">
            <label class="text-lg font-bold text-gray-800">Quick Help 👇</label>
            <button id="musicToggle" class="text-sm text-gray-600 hover:text-orange-600 flex items-center gap-2 transition-all hover:scale-105 font-semibold">
              <svg class="icon w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"/></svg>
              <span id="musicLabel">Play Flute</span>
            </button>
          </div>
          <div class="space-y-4">
            <select id="categorySelect" class="block w-full px-5 py-4 text-base border-2 border-gray-200 focus:outline-none focus:ring-3 focus:ring-blue-500 focus:border-blue-500 rounded-2xl bg-white shadow-md transition-all duration-300 font-medium">
              <option value="" selected disabled>Select Topic</option>
            </select>
            <select id="questionSelect" class="block w-full px-5 py-4 text-base border-2 border-gray-200 focus:outline-none focus:ring-3 focus:ring-blue-500 focus:border-blue-500 rounded-2xl bg-white shadow-md transition-all duration-300 font-medium" disabled>
              <option value="" selected disabled>Select Question</option>
            </select>
          </div>
        </div>

        <button 
          id="submitBtn" 
          class="w-full mt-4 btn-primary flex items-center justify-center gap-3 text-xl slide-fade-enter"
        >
          <svg class="icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
          </svg>
          Submit
        </button>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-6 mb-2 mt-2">
        <div class="event-card bg-gradient-to-br from-blue-50 to-blue-100 border-l-4 border-blue-600 shadow-lg">
          <div class="flex items-center gap-3 mb-2">
            <svg class="icon w-8 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
            <p class="font-bold text-gray-900 text-lg">Craft Fair</p>
          </div>
          <p class="text-sm text-gray-700 font-semibold ml-11">15 Nov – 5 Dec 2025</p>
        </div>
        <div class="event-card bg-gradient-to-br from-amber-50 to-amber-100 border-l-4 border-amber-600 shadow-lg">
          <div class="flex items-center gap-3 mb-2">
            <svg class="icon w-8 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/></svg>
            <p class="font-bold text-gray-900 text-lg">Daily Quiz</p>
          </div>
          <p class="text-sm text-gray-700 font-semibold ml-11">4 – 14 Nov 2025</p>
        </div>
        <div class="event-card bg-gradient-to-br from-green-50 to-green-100 border-l-4 border-green-600 shadow-lg">
          <div class="flex items-center gap-3 mb-2">
            <svg class="icon w-8 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"/></svg>
            <p class="font-bold text-gray-900 text-lg">Cultural Programs</p>
          </div>
          <p class="text-sm text-gray-700 font-semibold ml-11">24 Nov – 1 Dec 2025</p>
        </div>
      </div>

      <div class="quote-section mb-8">
        <p class="text-2xl devanagari text-gray-900 text-center leading-relaxed mb-4 relative z-10 font-semibold">
          "ज्ञानं तेऽहं सविज्ञानमिदं वक्ष्याम्यशेषतः।<br>यज्ज्ञात्वा नेह भूयोऽन्यज्ज्ञातव्यमवशिष्यते॥"
        </p>
        <p class="text-right text-gray-600 text-sm mb-4 devanagari font-medium">— श्रीमद्भगवद्गीता, अध्याय 7, श्लोक 2</p>
        <p class="text-center text-base text-gray-800 font-medium leading-relaxed italic">
          "I shall now declare to you in full this knowledge with realization,<br>knowing which nothing else remains to be known in this world."
        </p>
      </div>

      <div class="text-center">
        <a href="https://internationalgitamahotsav.in/" id="mainReturnLink" class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 font-semibold transition-all hover:scale-105">
          <svg class="icon w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
          Return to Main Page
        </a>
      </div>
    </div>

<div class="border-t border-gray-200/50 p-10 text-center bg-gradient-to-b from-white via-gray-50/30 to-white relative overflow-hidden">
  <!-- Subtle background accent -->
  <div class="absolute inset-0 bg-gradient-to-r from-orange-500/5 via-purple-500/5 to-blue-500/5 pointer-events-none"></div>
  
  <div class="relative z-10">
    <!-- AI Branding - Hero statement -->
    <div class="mb-6">
      <p class="text-xs uppercase tracking-widest text-gray-400 mb-2 font-semibold">Powered by Advanced AI</p>
      <p class="text-2xl font-bold bg-gradient-to-r from-orange-600 via-red-500 to-purple-600 bg-clip-text text-transparent">
        Groq + Llama 3.3
      </p>
      <p class="text-xs text-gray-500 mt-1 italic">Lightning-fast inference • State-of-the-art accuracy</p>
    </div>
    
    <!-- Timestamp -->
    <p class="text-gray-400 text-xs mb-8 font-mono">
      Last Updated: <span id="lastModified" class="text-gray-600"></span>
    </p>
    
    <!-- Logos with elegant spacing -->
    <div class="flex justify-center items-center gap-12 pt-4">
      <img 
        src="https://raw.githubusercontent.com/vksinglakkr/IGM2025/main/Images/haryana-logo.jpg" 
        alt="Haryana Government" 
        class="w-14 h-14 object-contain opacity-70 hover:opacity-100 transition-all duration-300 hover:scale-110 filter hover:drop-shadow-lg"
      >
      <div class="w-px h-12 bg-gradient-to-b from-transparent via-gray-300 to-transparent"></div>
      <img 
        src="https://raw.githubusercontent.com/vksinglakkr/IGM2025/main/Images/kdb-logo.png" 
        alt="Kurukshetra Development Board" 
        class="w-14 h-14 object-contain opacity-70 hover:opacity-100 transition-all duration-300 hover:scale-110 filter hover:drop-shadow-lg"
      >
    </div>
  </div>
</div>
  </div>

  <div id="aiModal" class="hidden fixed inset-0 flex items-center justify-center p-2" style="z-index: 9999; background: rgba(0,0,0,0.92);">
    <div class="bg-white rounded-3xl shadow-2xl w-full mx-2 modal-enter overflow-hidden" style="max-width: 850px; max-height: 92vh;">
      <div class="flex justify-between items-center px-5 py-4 bg-gradient-to-r from-blue-600 to-indigo-700 text-white">
        <h2 class="text-xl font-bold flex items-center gap-2">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>
          AI Response
        </h2>
        <button id="closeModal" class="hover:bg-white/20 p-2 rounded-full transition">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>

      <div class="p-5 overflow-y-auto bg-gray-50" style="max-height: calc(92vh - 180px);">
        <div class="mb-5">
          <div class="flex items-center gap-2 mb-2">
            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            <p class="font-bold text-gray-900">Question:</p>
          </div>
          <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-2xl border-l-4 border-blue-500">
            <pre id="modalQuestion" class="whitespace-pre-wrap text-gray-800 text-sm leading-relaxed"></pre>
          </div>
        </div>

        <div>
          <div class="flex items-center justify-between mb-2 flex-wrap gap-2">
            <div class="flex items-center gap-2">
              <svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>
              <p class="font-bold text-gray-900">Answer:</p>
            </div>
            <button id="ttsToggle" class="tts-btn bg-gradient-to-r from-orange-500 to-orange-600 text-white">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"/></svg>
              <span id="ttsLabel">Listen</span>
            </button>
          </div>
          <div class="bg-gradient-to-br from-amber-50 to-orange-50 p-4 rounded-2xl border-l-4 border-orange-500">
            <pre id="modalAnswer" class="whitespace-pre-wrap text-gray-800 text-sm leading-loose devanagari"></pre>
          </div>
        </div>
      </div>

      <div class="border-t-2 border-gray-200 p-3 bg-white flex justify-center gap-2">
        <button id="copyBtn" class="flex items-center gap-1 px-4 py-2 bg-white border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition text-sm font-semibold">
          <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
          Copy
        </button>
        <a href="https://internationalgitamahotsav.in/" class="flex items-center gap-1 px-4 py-2 bg-white border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition text-sm font-semibold">
          <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
          Home
        </a>
        <button id="closeBtn" class="flex items-center gap-1 bg-gradient-to-r from-blue-600 to-blue-700 text-white px-5 py-2 rounded-xl hover:from-blue-700 hover:to-blue-800 transition text-sm font-bold shadow-lg">
          Close
        </button>
      </div>
    </div>
  </div>

  <audio id="fluteMusic" loop>
    <source src="https://vksinglakkr.github.io/IGM2025/audio/gentle-flute.mp3" type="audio/mpeg">
  </audio>

  <script>
// Category questions for different query types
const gitaQuestions = {
  'PHILOSOPHICAL_QUERY': [
    "How can one control anger according to the Bhagavad Gita?",
    "What does the Gita say about finding peace of mind?",
    "How can a person stay calm in success and failure as per the Gita?",
    "What guidance does the Gita give for overcoming fear and anxiety?",
    "How can one control desires and attachments according to Lord Krishna?",
    "What is the ultimate message of the Bhagavad Gita for a common person?"
  ]
};

const eventQuestions = {
  'EVENT_QUERY': [
    "What are the dates for the PM/CM/Governor visits?",
    "When is the main Gita Path ceremony scheduled?",
    "What cultural programs are scheduled for tomorrow?",
    "Tell me about the art and book exhibitions.",
    "What time is the Deep Daan ceremony today?",
    "I want to participate in the debate competition."
  ],
  'FACILITY_QUERY': [
    "Where is the nearest parking and is it free?",
    "Where can I find the food court or canteen?",
    "Are there any medical or first aid facilities near the main stage?",
    "Where is the Lost and Found counter?"
  ],
  'TRANSPORT_QUERY': [
    "What's the best way to reach Kurukshetra from Delhi by train?",
    "Are there shuttle bus services available during the festival?",
    "Where is the nearest taxi stand?"
  ],
  'GENERAL_INFO': [
    "What are the dates and timings for the Gita Mahotsav 2025?",
    "What is the official helpline number?",
    "Are there any entry fees for the main fair grounds?"
  ],
  'TOURISM_QUERY': [
    "What are the timings for Jyotisar and Brahma Sarovar?",
    "Can you suggest a sightseeing tour itinerary for the day?",
    "What is the historical significance of Krishna Museum?"
  ],
  'ACCOMMODATION_QUERY': [
    "Are there budget hotels available near the venue?",
    "How can I book a room in a nearby Dharamshala?",
    "Where can I find information on homestays?"
  ],
  'COMPETITION_QUERY': [
    "How do I register for the Gita Chanting competition?",
    "What are the eligibility criteria for the essay contest?",
    "What is the prize information for the painting contest?"
  ],
  'EMERGENCY_QUERY': [
    "What are the emergency contact numbers for the festival?",
    "Where is the police station or medical emergency center located?",
    "I have lost my child, where should I report it?"
  ],
  'FAQ_QUERY': [
    "What is the Gita Mahotsav?",
    "What are the general rules and regulations for visitors?",
    "What is the predicted weather forecast for the next week?"
  ]
};

let selectedQueryType = '';
let selectedLanguage = 'Hindi';

// Radio button selection handler
function selectQueryType(type) {
  selectedQueryType = type;
  const gitaRadio = document.getElementById('gitaRadio');
  const eventRadio = document.getElementById('eventRadio');
  const questionSection = document.getElementById('questionSection');
  const userInput = document.getElementById('userInput');
  
  if (type === 'gita') {
    gitaRadio.checked = true;
    gitaRadio.parentElement.classList.add('selected');
    eventRadio.parentElement.classList.remove('selected');
    populateCategoriesForGita();
    userInput.placeholder = 'Ask your question... e.g., "How to find inner peace?"';
  } else {
    eventRadio.checked = true;
    eventRadio.parentElement.classList.add('selected');
    gitaRadio.parentElement.classList.remove('selected');
    populateCategoriesForEvent();
    userInput.placeholder = 'Ask your question... e.g., "Where is parking?" or "Today\'s events?"';
  }
  
  questionSection.style.display = 'block';
  
  setTimeout(() => {
    questionSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }, 100);
}

function populateCategoriesForGita() {
  const categorySelect = document.getElementById('categorySelect');
  categorySelect.innerHTML = '<option value="" selected disabled>Select Topic</option>';
  categorySelect.innerHTML += '<option value="PHILOSOPHICAL_QUERY">🕉️ Gita Wisdom</option>';
  categorySelect.disabled = false;
  document.getElementById('questionSelect').innerHTML = '<option value="" selected disabled>Select Question</option>';
  document.getElementById('questionSelect').disabled = true;
  document.getElementById('userInput').value = '';
}

function populateCategoriesForEvent() {
  const categorySelect = document.getElementById('categorySelect');
  categorySelect.innerHTML = '<option value="" selected disabled>Select Topic</option>';
  categorySelect.innerHTML += '<option value="EVENT_QUERY">📅 Events & Schedule</option>';
  categorySelect.innerHTML += '<option value="FACILITY_QUERY">🏢 Facilities</option>';
  categorySelect.innerHTML += '<option value="TRANSPORT_QUERY">🚗 Transport & Travel</option>';
  categorySelect.innerHTML += '<option value="GENERAL_INFO">ℹ️ General Info</option>';
  categorySelect.innerHTML += '<option value="TOURISM_QUERY">🛕 Tourist Places</option>';
  categorySelect.innerHTML += '<option value="ACCOMMODATION_QUERY">🏨 Accommodation</option>';
  categorySelect.innerHTML += '<option value="COMPETITION_QUERY">🏆 Competitions</option>';
  categorySelect.innerHTML += '<option value="EMERGENCY_QUERY">🚨 Emergency Help</option>';
  categorySelect.innerHTML += '<option value="FAQ_QUERY">❓ Common Questions</option>';
  categorySelect.disabled = false;
  document.getElementById('questionSelect').innerHTML = '<option value="" selected disabled>Select Question</option>';
  document.getElementById('questionSelect').disabled = true;
  document.getElementById('userInput').value = '';
}

const lastModifiedDate = new Date(document.lastModified);
document.getElementById("lastModified").textContent = lastModifiedDate.toLocaleDateString('en-US', {
  year: 'numeric', month: 'long', day: 'numeric'
}) + ' at ' + lastModifiedDate.toLocaleTimeString('en-US', {
  hour: '2-digit', minute: '2-digit'
});

const categorySelect = document.getElementById('categorySelect');
const questionSelect = document.getElementById('questionSelect');
const userQueryInput = document.getElementById('userInput');

function populateQuestions(category) {
  questionSelect.innerHTML = '<option value="" selected disabled>Select Question</option>';
  questionSelect.disabled = true;
  
  let questions = [];
  if (selectedQueryType === 'gita' && gitaQuestions[category]) {
    questions = gitaQuestions[category];
  } else if (selectedQueryType === 'event' && eventQuestions[category]) {
    questions = eventQuestions[category];
  }
  
  if (questions.length > 0) {
    questions.forEach(q => {
      const option = document.createElement('option');
      option.value = q;
      option.textContent = q;
      questionSelect.appendChild(option);
    });
    questionSelect.disabled = false;
  }
}

categorySelect.addEventListener('change', () => {
  populateQuestions(categorySelect.value);
  userQueryInput.value = '';
});

questionSelect.addEventListener('change', () => {
  userQueryInput.value = questionSelect.value;
});

document.querySelectorAll('.langBtn').forEach(btn => {
  btn.addEventListener('click', function() {
    selectedLanguage = this.dataset.lang;
    document.querySelectorAll('.langBtn').forEach(b => b.classList.remove('active'));
    this.classList.add('active');
  });
});

let ttsUtterance = null;
let isSpeaking = false;
let voicesLoaded = false;
let manualStop = false; // Add this flag

// Ensure voices are loaded (critical for iOS)
function loadVoices() {
  return new Promise((resolve) => {
    let voices = speechSynthesis.getVoices();
    if (voices.length > 0) {
      voicesLoaded = true;
      resolve(voices);
    } else {
      speechSynthesis.addEventListener('voiceschanged', () => {
        voices = speechSynthesis.getVoices();
        voicesLoaded = true;
        resolve(voices);
      }, { once: true });
      
      // Fallback timeout for iOS
      setTimeout(() => {
        voices = speechSynthesis.getVoices();
        voicesLoaded = true;
        resolve(voices);
      }, 1000);
    }
  });
}

// Load voices on page load
loadVoices();    
document.getElementById('ttsToggle').addEventListener('click', async () => {
  const ttsBtn = document.getElementById('ttsToggle');
  const ttsLabel = document.getElementById('ttsLabel');
  const answerText = document.getElementById('modalAnswer').textContent;
  
  if (!answerText || answerText === 'Thinking...') return;
  
  if (isSpeaking) {
    // User manually stopped
    manualStop = true; // Set flag before canceling
    speechSynthesis.cancel();
    isSpeaking = false;
    ttsBtn.classList.remove('speaking');
    ttsLabel.textContent = 'Listen';
    return;
  }
  
  // Reset manual stop flag
  manualStop = false;
  
  // Ensure voices are loaded
  const voices = await loadVoices();
  
  // Cancel any ongoing speech
  speechSynthesis.cancel();
  
  // Small delay for iOS (helps prevent issues)
  await new Promise(resolve => setTimeout(resolve, 100));
  
  ttsUtterance = new SpeechSynthesisUtterance(answerText);
  
  // iOS-friendly settings
  ttsUtterance.rate = 0.85;
  ttsUtterance.pitch = 1;
  ttsUtterance.volume = 1;
  
  // Try to find Hindi voice, fallback to default
  let selectedVoice = null;
  
  // Look for Hindi voices (hi-IN)
  const hindiVoices = voices.filter(voice => 
    voice.lang.startsWith('hi') || 
    voice.lang === 'hi-IN' ||
    voice.name.toLowerCase().includes('hindi')
  );
  
  if (hindiVoices.length > 0) {
    selectedVoice = hindiVoices[0];
    console.log('Using Hindi voice:', selectedVoice.name);
  } else {
    // Fallback to first available voice
    selectedVoice = voices[0];
    console.log('Hindi voice not found, using:', selectedVoice?.name || 'default');
    
    // Alert user on iOS if no Hindi voice (only once)
    if (/iPhone|iPad|iPod/i.test(navigator.userAgent) && !sessionStorage.getItem('hindiVoiceWarned')) {
      alert('Hindi voice not available. Using default voice. To enable Hindi, go to Settings > Accessibility > Spoken Content > Voices > Hindi.');
      sessionStorage.setItem('hindiVoiceWarned', 'true');
    }
  }
  
  if (selectedVoice) {
    ttsUtterance.voice = selectedVoice;
  }
  
  ttsUtterance.onstart = () => {
    isSpeaking = true;
    ttsBtn.classList.add('speaking');
    ttsLabel.textContent = 'Stop';
  };
  
  ttsUtterance.onend = () => {
    // Only update UI if not manually stopped
    if (!manualStop) {
      isSpeaking = false;
      ttsBtn.classList.remove('speaking');
      ttsLabel.textContent = 'Listen';
    }
  };
  
  ttsUtterance.onerror = (e) => {
    console.error('TTS Error:', e);
    
    // Don't show error if user manually stopped
    if (manualStop) {
      manualStop = false; // Reset flag
      return;
    }
    
    isSpeaking = false;
    ttsBtn.classList.remove('speaking');
    ttsLabel.textContent = 'Listen';
    
    // More specific error messages for actual errors
    let errorMsg = 'Speech failed. ';
    if (e.error === 'canceled' || e.error === 'interrupted') {
      // Silently ignore canceled/interrupted errors
      return;
    } else if (e.error === 'not-allowed') {
      errorMsg += 'Please enable speech in browser settings.';
    } else if (e.error === 'language-unavailable') {
      errorMsg += 'Hindi voice not available on your device.';
    } else {
      errorMsg += 'Please try again.';
    }
    alert(errorMsg);
  };
  
  // iOS requires immediate speech after user interaction
  try {
    speechSynthesis.speak(ttsUtterance);
  } catch (error) {
    console.error('Speech synthesis failed:', error);
    alert('Text-to-speech is not available on your device.');
  }
});
    
document.getElementById('submitBtn').addEventListener('click', async () => {
  const question = document.getElementById('userInput').value.trim();
  
  if (!selectedQueryType) {
    alert('Please select either "Gita Guidance" or "Festival Information" first!');
    return;
  }
  
  if (!question) {
    alert('Please enter your question!');
    return;
  }

  const mainContainer = document.querySelector('.container-main');
  if (mainContainer) mainContainer.style.visibility = 'hidden';

  speechSynthesis.cancel();
  isSpeaking = false;
  document.getElementById('ttsToggle').classList.remove('speaking');
  document.getElementById('ttsLabel').textContent = 'Listen';

  document.getElementById('modalQuestion').textContent = question;
  document.getElementById('modalAnswer').textContent = 'Thinking...';
  document.getElementById('aiModal').classList.remove('hidden');

  const deviceType = /Mobile|Android|iPhone|iPad|iPod/i.test(navigator.userAgent) ? 'Mobile' : 
                     /Tablet|iPad/i.test(navigator.userAgent) ? 'Tablet' : 'Desktop';
  const browserMatch = navigator.userAgent.match(/(Firefox|Chrome|Safari|Edge|Opera|OPR)/i);
  const browser = browserMatch ? browserMatch[0].replace('OPR', 'Opera') : 'Unknown';

  let geoLocation = { latitude: 'Not Available', longitude: 'Not Available' };
  try {
    if (navigator.geolocation) {
      const position = await new Promise((resolve, reject) => {
        navigator.geolocation.getCurrentPosition(resolve, reject, { 
          timeout: 3000,
          enableHighAccuracy: false 
        });
      });
      geoLocation.latitude = position.coords.latitude.toFixed(6);
      geoLocation.longitude = position.coords.longitude.toFixed(6);
    }
  } catch (error) {
    console.log('Geolocation not available');
  }

  try {
    const webhookUrl = 'https://vksinglakkrgroq1.app.n8n.cloud/webhook/ask-gitaV2';

    const response = await fetch(webhookUrl, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        question: question,
        language: selectedLanguage,
        queryType: selectedQueryType === 'gita' ? 'PHILOSOPHICAL_AI_QUERY' : 'PRACTICAL_INFO_QUERY',
        mobNo: 'anonymous',
        deviceType: deviceType,
        browser: browser,
        latitude: geoLocation.latitude,
        longitude: geoLocation.longitude,
        timestamp: new Date().toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' }),
        userAgent: navigator.userAgent
      })
    });

    const data = await response.json();
    document.getElementById('modalAnswer').textContent = data.answer || data.error || 'No response received.';
  } catch (error) {
    document.getElementById('modalAnswer').textContent = 'Connection failed: ' + error.message;
  }
});

let recognition;
let isRecording = false;

if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  recognition = new SpeechRecognition();
  recognition.continuous = false;
  recognition.interimResults = false;
  recognition.lang = 'hi-IN';

  recognition.onstart = () => {
    isRecording = true;
    const voiceBtn = document.getElementById('voiceBtn');
    voiceBtn.classList.add('recording');
    voiceBtn.title = 'Recording... Click to stop';
  };

  recognition.onresult = (event) => {
    const transcript = event.results[0][0].transcript;
    document.getElementById('userInput').value = transcript;
  };

  recognition.onend = () => {
    isRecording = false;
    const voiceBtn = document.getElementById('voiceBtn');
    voiceBtn.classList.remove('recording');
    voiceBtn.title = 'Click to speak';
  };

  recognition.onerror = (event) => {
    console.error('Speech recognition error:', event.error);
    isRecording = false;
    const voiceBtn = document.getElementById('voiceBtn');
    voiceBtn.classList.remove('recording');
    voiceBtn.title = 'Click to speak';
    if (event.error !== 'no-speech') {
      alert('Voice recognition failed. Please try again.');
    }
  };
}

document.getElementById('voiceBtn').addEventListener('click', (e) => {
  e.preventDefault();
  if (recognition) {
    if (isRecording) {
      recognition.stop();
    } else {
      recognition.start();
    }
  } else {
    alert('Voice recognition is not supported in your browser.');
  }
});

document.getElementById('closeBtn').onclick = () => {
  speechSynthesis.cancel();
  document.getElementById('aiModal').classList.add('hidden');
  const mainContainer = document.querySelector('.container-main');
  if (mainContainer) mainContainer.style.visibility = 'visible';
};

document.getElementById('closeModal').onclick = () => {
  speechSynthesis.cancel();
  document.getElementById('aiModal').classList.add('hidden');
  const mainContainer = document.querySelector('.container-main');
  if (mainContainer) mainContainer.style.visibility = 'visible';
};

document.getElementById('copyBtn').onclick = () => {
  const text = document.getElementById('modalAnswer').textContent;
  navigator.clipboard.writeText(text).then(() => {
    const btn = document.getElementById('copyBtn');
    const originalHTML = btn.innerHTML;
    btn.innerHTML = '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg> Copied!';
    setTimeout(() => { btn.innerHTML = originalHTML; }, 2000);
  });
};

const fluteMusic = document.getElementById('fluteMusic');
const musicToggle = document.getElementById('musicToggle');
const musicLabel = document.getElementById('musicLabel');

musicToggle.addEventListener('click', () => {
  if (fluteMusic.paused) {
    fluteMusic.play().catch(e => {
      console.warn("Audio play blocked:", e);
      alert("Please interact with the page first, then click to play music.");
    });
    musicLabel.textContent = "Pause Flute";
  } else {
    fluteMusic.pause();
    musicLabel.textContent = "Play Flute";
  }
});
  </script>
</body>
</html>
